# yt-dlp 配置文件模板

## 基础配置文件

位置: `~/.config/yt-dlp/yt-dlp.conf` (Linux/macOS) 或 `%APPDATA%\yt-dlp\yt-dlp.conf` (Windows)

```ini
# 基础配置
# ============================================

# 输出目录和文件名
-o ~/Downloads/%(title)s.%(ext)s
--paths ~/Downloads

# 格式选择
-f bestvideo+bestaudio
--merge-output-format mp4

# 字幕
--write-subs
--sub-langs en,zh-Hans,zh-Hant
--embed-subs

# 元数据
--write-description
--write-info-json
--write-thumbnail
--embed-metadata
--embed-thumbnail

# 缓存
--no-cache

# 日志
--newline
```

## 音频专用配置

```ini
# 音频下载配置
# ============================================

# 输出
-o ~/Music/%(title)s.%(ext)s

# 只下载音频
-x
--audio-format mp3
--audio-quality 0

# 元数据
--embed-metadata
--write-thumbnail

# 合并选项
--no-post-overwrites
```

## 视频高质量配置

```ini
# 高质量视频配置
# ============================================

# 格式选择（最高 4K）
-f bestvideo[height<=2160]+bestaudio

# 合并格式
--merge-output-format mkv

# 字幕
--write-subs --all-subs
--embed-subs

# 元数据
--write-description
--write-info-json
--write-thumbnail
--embed-metadata
--embed-thumbnail

# 下载选项
--concurrent-fragments 2
```

## 播放列表配置

```ini
# 播放列表配置
# ============================================

# 输出模板
-o ~/Downloads/Playlists/%(playlist_title)s/%(playlist_index)03d - %(title)s.%(ext)s

# 格式
-f bestvideo[height<=1080]+bestaudio

# 播放列表选项
--playlist-reverse
--ignore-errors

# 批量处理
--concat-playlist
```

## 快速下载配置

```ini
# 快速下载配置
# ============================================

# 较低质量但快速下载
-f worst

# 不后处理
--no-post-overwrites
--skip-download

# 禁用缓存
--no-cache

# 简单输出
--newline
```

## 调试配置

```ini
# 调试配置
# ============================================

# 详细输出
-v
--print-traffic
--write-pages

# 保存信息
--write-info-json
--write-description

# 不下载
--skip-download

# 保存页面
--write-pages
```

## 代理和认证配置

```ini
# 代理配置
# ============================================

# HTTP 代理
--proxy http://127.0.0.1:8080

# SOCKS5 代理
# --proxy socks5://127.0.0.1:1080

# 从浏览器导入 cookies
--cookies-from-browser chrome

# 或使用 cookies 文件
# --cookies cookies.txt
```

## 完整配置示例

```ini
# yt-dlp 完整配置文件
# ============================================

# === 输出设置 ===
# 默认输出目录
--paths ~/Downloads

# 文件名模板
-o %(uploader)s/%(upload_date)s - %(title)s.%(ext)s

# Windows 兼容文件名
--windows-filenames

# 限制文件名为 ASCII
--restrict-filenames

# === 格式选择 ===
# 视频格式（最高 1080p）
-f bestvideo[height<=1080][ext=mp4]+bestaudio[ext=m4a]/best[ext=mp4]/best

# 合并格式
--merge-output-format mp4

# === 后处理 ===
# 嵌入元数据
--embed-metadata

# 嵌入字幕
--embed-subs

# 嵌入缩略图
--embed-thumbnail

# SponsorBlock
--sponsorblock-remove sponsor,intro,outro,selfpromo

# === 字幕 ===
# 写入字幕
--write-subs

# 字幕语言
--sub-langs en,zh-Hans,zh-Hant

# 写入自动字幕
--write-auto-subs

# === 元数据 ===
# 写入描述
--write-description

# 写入 info.json
--write-info-json

# 写入缩略图
--write-thumbnail

# 写入注释
--write-annotations

# === 下载选项 ===
# 并发片段
--concurrent-fragments 2

# 外部下载器
# --external-downloader aria2
# --external-downloader-args "-x 8 -k 1M"

# 限速
# --limit-rate 1M

# 重试次数
--retries 10

# 片段重试
--fragment-retries 10

# 跳过不可用片段
--skip-unavailable-fragments

# === 缓存 ===
# 缓存目录
--cache-dir ~/.cache/yt-dlp

# === 日志 ===
# 详细输出
# -v

# 新行进度
--newline

# 忽略警告
# --no-warnings

# 静默模式
# --quiet

# === 播放列表 ===
# 不下载播放列表
# --no-playlist

# 播放列表起始
# --playliststart 1

# 播放列表结束
# --playlistend 10

# 播放列表倒序
# --playlist-reverse

# === 认证 ===
# 用户名密码
# -u username
# -p password

# 视频密码
# --video-password password

# 从浏览器导入 cookies
# --cookies-from-browser chrome

# === 其他 ===
# 忽略错误
--ignore-errors

# 不检查证书
# --no-check-certificate

# 优先 HTTP
# --prefer-insecure

# 标记下载的文件
# --mark-watched
```

## 按网站配置

```ini
# YouTube 特定配置
# ============================================
# 保存为: ~/.config/yt-dlp/yt-dlp.conf

# YouTube 视频格式
-f bestvideo[height<=1080][ext=mp4]+bestaudio[ext=m4a]/best[ext=mp4]/best

# SponsorBlock
--sponsorblock-remove sponsor,intro,outro,selfpromo,music_offtopic
```

## 便携式配置

在下载目录创建 `yt-dlp.conf`:

```ini
# 便携式配置（在当前目录）
# ============================================

# 输出到当前目录
-o ./%(title)s.%(ext)s

# 格式
-f best

# 日志
--newline
```

使用:
```bash
cd /path/to/download/dir
yt-dlp "URL"  # 自动使用当前目录的 yt-dlp.conf
```

## JSON 配置

yt-dlp 也支持 JSON 格式配置:

```json
{
  "outtmpl": "%(title)s.%(ext)s",
  "format": "bestvideo+bestaudio",
  "merge_output_format": "mp4",
  "postprocessors": [
    {
      "key": "FFmpegMetadata"
    },
    {
      "key": "EmbedThumbnail"
    }
  ],
  "writesubtitles": true,
  "subtitleslangs": ["en", "zh-Hans"]
}
```

使用:
```bash
yt-dlp --config-location config.json "URL"
```

## 配置文件优先级

```
1. 命令行参数 (最高优先级)
2. 便携配置: ./yt-dlp.conf
3. 用户配置: ~/.config/yt-dlp/yt-dlp.conf
4. 系统配置: /etc/yt-dlp.conf
```

## 环境变量

```bash
# 设置缓存目录
export XDG_CACHE_HOME=~/.cache

# 设置配置目录
export XDG_CONFIG_HOME=~/.config

# 设置 yt-dlp 缓存
export YTDL_CACHE_DIR=~/.cache/yt-dlp
```
